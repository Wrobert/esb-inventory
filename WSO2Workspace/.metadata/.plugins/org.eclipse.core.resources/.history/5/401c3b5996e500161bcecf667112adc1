<?xml version="1.0" encoding="UTF-8"?>
<template name="FileConnectorTemplate" xmlns="http://ws.apache.org/ns/synapse">
    <sequence>
        <log level="full"/>
        <property expression="//operation" name="operation" scope="default" type="STRING"/>
        <property expression="//fileLocation" name="fileLocation" scope="default" type="STRING"/>
        <property expression="//fileName" name="fileName" scope="default" type="STRING"/>
        <property expression="//newFileLocation" name="newFileLocation" scope="default" type="STRING"/>
        <property expression="//fileBeforeProcess" name="fileBeforeProcess" scope="default" type="STRING"/>
        <property expression="//fileAfterProcess" name="fileAfterProcess" scope="default" type="STRING"/>
        <property name="OUT_ONLY" scope="default" type="STRING" value="true"/>
        <switch source="get-property('operation')">
            <case regex="READ">
                <log level="custom">
                    <property expression="get-property('operation')" name="Operation"/>
                </log>
                <fileconnector.read>
                    <source>{$ctx:fileLocation}</source>
                    <contentType>Application/xml</contentType>
                    <filePattern>{$ctx:fileName}</filePattern>
                </fileconnector.read>
            </case>
            <case regex="MOVE">
                <log level="custom">
                    <property expression="get-property('operation')" name="Operation"/>
                </log>
                <fileconnector.move>
                    <source>{$ctx:fileLocation}</source>
                    <destination>{$ctx:newFileLocation}</destination>
                </fileconnector.move>
            </case>
            <case regex="COPY">
                <log level="custom">
                    <property expression="get-property('operation')" name="Operation"/>
                </log>
                <fileconnector.copy>
                    <source>{$ctx:fileBeforeProcess}</source>
                    <destination>{$ctx:fileLocation}</destination>
                    <filePattern>{$ctx:fileName}</filePattern>
                </fileconnector.copy>
            </case>
            <case regex="DELETE">
                <log level="custom">
                    <property expression="get-property('operation')" name="Operation"/>
                </log>
                <fileconnector.delete>
                    <source>{$ctx:fileLocation}</source>
                </fileconnector.delete>
            </case>
            <default>
                <log level="custom">
                    <property name="Operation" value="Undefined."/>
                    <property expression="get-property('operation')" name="Default selected because of"/>
                </log>
            </default>
        </switch>
    </sequence>
</template>

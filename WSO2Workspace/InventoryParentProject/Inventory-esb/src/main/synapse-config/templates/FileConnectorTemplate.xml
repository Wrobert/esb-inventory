<?xml version="1.0" encoding="UTF-8"?>
<template name="FileConnectorTemplate" xmlns="http://ws.apache.org/ns/synapse">
    <parameter name="ArgOperation"/>
    <parameter name="ArgSource"/>
    <parameter name="ArgFilePattern"/>
    <parameter name="ArgContentType"/>
    <parameter name="ArgInputContent"/>
    <sequence>
        <log level="custom" separator=",">
            <property name="FileConnectorTemplate" value="FileConnectorTemplate Started."/>
            <property expression="$func:ArgOperation" name="argOperation"/>
            <property expression="$func:ArgSource" name="argSource"/>
            <property expression="$func:ArgFilePattern" name="argFilePattern"/>
            <property expression="$func:ArgContentType" name="argContentType"/>
            <property expression="$func:ArgInputContent" name="argInputContent"/>
        </log>
        <switch source="$func:ArgOperation">
            <case regex="READ">
                <log level="custom">
                    <property name="Case" value="READ"/>
                </log>
                <!-- READ FILE -->
                <fileconnector.read>
                    <source>{$func:ArgSource}</source>
                    <contentType>{$func:ArgContentType}</contentType>
                    <filePattern>{$func:ArgFilePattern}</filePattern>
                </fileconnector.read>
            </case>
            <case regex="WRITE">
                <log level="custom">
                    <property name="Case" value="WRITE"/>
                </log>
                <property name="FORCE_SC_ACCEPTED" scope="transport" type="STRING" value="true"/>
                <property name="OUT_ONLY" scope="default" type="STRING" value="true"/>
                <fileconnector.create>
                    <source>{$func:ArgSource}</source>
                    <inputContent>{$func:ArgInputContent}</inputContent>
                    <encoding>UTF-8</encoding>
                </fileconnector.create>
            </case>
            <case regex="DELETE">
                <log level="custom">
                    <property name="Case" value="DELETE"/>
                </log>
                <fileconnector.delete>
                    <source>{$func:ArgSource}</source>
                </fileconnector.delete>
            </case>
            <default>
                <log level="custom">
                    <property name="ArgOperation" value="Undefined."/>
                    <property expression="get-property('argOperation')" name="Default process selected because of operation = "/>
                </log>
            </default>
        </switch>
        <!-- 
            <case regex="MOVE">
                <log level="custom">
                    <property expression="get-property('ArgOperation')" name="ArgOperation"/>
                </log>
                <fileconnector.move>
                    <source>{$ctx:ArgSource}</source>
                    <destination>{$ctx:ArgFileAfterProcess}</destination>
                </fileconnector.move>
            </case>
            <case regex="COPY">
                <log level="custom">
                    <property expression="get-property('ArgOperation')" name="ArgOperation"/>
                </log>
                <fileconnector.copy>
                    <source>{$ctx:ArgFileBeforeProcess}</source>
                    <destination>{$ctx:ArgSource}</destination>
                    <filePattern>{$ctx:ArgFilePattern}</filePattern>
                </fileconnector.copy>
            </case>
  -->
    </sequence>
</template>
